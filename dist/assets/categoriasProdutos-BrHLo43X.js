import{a as s,f as w,j as r,R as mo,l as ho,m as Q}from"./GlobalStyles-Dqpp29B9.js";import{C as po,a as go,b as xo,F as y,c as E,d as $,B as fo,e as q,I as _o,f as V,L as X,g as z,T as jo,h as Co,i as So,j as Po,k as bo,l as Fo,N as Ao,D as vo,m as yo,n as H}from"./CategoriaProdutosStyle-Bi6KNH5F.js";import{T as Eo,a as $o,b as Bo,c as ko}from"./index-CJGrLZTX.js";import{c as wo}from"./index-U_MZ96hN.js";import{a as Io,S as Do,b as B,I as No,P as Ro,c as k,C as To,B as U}from"./ProdutoStyles-Cz6hDj1C.js";import{U as Lo}from"./userContext-Hfd7AKwO.js";import{a as x}from"./axios-DnYME9kn.js";import{B as K}from"./HomePageStyles-CJMC4Gvw.js";import{S as W}from"./SpinnerComponent-D-z1JUIS.js";const Y=({titulo:d,subtitulo:h,produtos:C})=>{const{user:e}=s.useContext(Lo),[f,g]=s.useState(null),[p,u]=s.useState(""),[S,l]=s.useState(""),[I,D]=s.useState(""),[P,b]=s.useState({}),[_,F]=s.useState({}),Z=w();s.useEffect(()=>{if(e&&e.id_user){const t=(JSON.parse(localStorage.getItem(`listaAmei_${e.id_user}`))||[]).reduce((a,i)=>(a[i.id_produto]=!0,a),{});b(t)}},[e]),s.useEffect(()=>{if(e&&e.id_user){const t=(JSON.parse(localStorage.getItem(`carrinho${e.id_user}`))||[]).reduce((a,i)=>(a[i.id_produto]=!0,a),{});F(t)}},[e]);const A=o=>typeof o!="number"?"0,00":o.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),oo=o=>{if(!o)return"";const t={calcas:"calças",acessorios:"acessórios",bones:"bonés",lancamentos:"lançamentos",promocoes:"promoções"};let a=o;for(let i in t){const m=new RegExp(`\\b${i}\\b`,"g");a=a.replace(m,t[i])}return a},ro=o=>!o||o===1?"À vista":`Em até ${o}X`,N=o=>{u(p===o?null:o)},to=(o,t,a,i,m)=>{if(!Array.isArray(o))return console.error("Produtos não é um array válido"),[];let n=o;return t&&(n=n.filter(c=>c.cor_produto===t)),a&&(n=n.filter(c=>c.tamanho_produto===a)),i&&m&&(n=n.filter(c=>{const G=c.categoria_produto==="promocoes"&&c.preco_promocional_produto?c.preco_promocional_produto:c.preco_produto;return G>=i&&G<=m})),n},ao=[{nome:"amarelo",cor:"#FFF800"},{nome:"azul",cor:"#007BFF"},{nome:"branco",cor:"#fff"},{nome:"cinza",cor:"#737373"},{nome:"laranja",cor:"#FA5400"},{nome:"marrom",cor:"#8C5900"},{nome:"nude",cor:"#F2D2BD"},{nome:"preto",cor:"#000"},{nome:"rosa",cor:"#FFDBDB"},{nome:"rosê",cor:"#C21E56"},{nome:"roxo",cor:"#A347FF"},{nome:"verde",cor:"#00AD1D"},{nome:"vermelho",cor:"#8C0000"}],eo=async o=>{if(!(e!=null&&e.id_user)){alert("Você precisa estar logado para adicionar à lista amei.");return}const t=e.id_user;try{const a=JSON.parse(localStorage.getItem(`listaAmei_${t}`))||[];if(a.some(c=>c.id_produto===o.id_produto)||(await x.get(`http://localhost:3001/aurea/lista-amei/${t}`)).data.some(c=>c.id_produto===o.id_produto))return;const n=await x.post("http://localhost:3001/aurea/lista-amei",{id_user:t,id_produto:o.id_produto});if(n.status!==200&&n.status!==201)throw new Error('Erro ao adicionar o produto à lista "Amei".');a.push(o),localStorage.setItem(`listaAmei_${t}`,JSON.stringify(a)),b(c=>({...c,[o.id_produto]:!0}))}catch(a){console.error('Erro ao adicionar à lista "Amei":',a.response?a.response.data:a.message),alert("Erro ao adicionar o produto à lista.")}},so=async o=>{try{const t=e.id_user;await x.delete(`http://localhost:3001/aurea/lista-amei/${t}/${o}`);const i=(JSON.parse(localStorage.getItem(`listaAmei_${t}`))||[]).filter(m=>m.id_produto!==o);localStorage.setItem(`listaAmei_${t}`,JSON.stringify(i)),b(m=>({...m,[o]:!1}))}catch(t){console.error('Erro ao remover produto da lista "Amei":',t),alert("Erro ao remover o produto da lista.")}},R=async o=>{if(!(e!=null&&e.id_user)){alert("Você precisa estar logado para adicionar ao carrinho.");return}const t=e.id_user;if(o.qtd_produto===0){alert("Você não pode colocar um produto sem estoque no carrinho.");return}else try{const a=JSON.parse(localStorage.getItem(`carrinho${t}`))||[];if(a.some(n=>n.id_produto===o.id_produto)||(await x.get(`http://localhost:3001/aurea/carrinho/${t}`)).data.some(n=>n.id_produto===o.id_produto))return;await x.post("http://localhost:3001/aurea/carrinho",{id_user:t,id_produto:o.id_produto,qtd_produto_carrinho:1}),a.push(o),localStorage.setItem(`carrinho${t}`,JSON.stringify(a)),F(n=>({...n,[o.id_produto]:!0}))}catch(a){console.error("Erro ao adicionar ao carrinho:",a),alert("Erro ao adicionar o produto no carrinho.")}},T=async o=>{try{await x.delete(`http://localhost:3001/aurea/carrinho/${e.id_user}/${o}`);const a=(JSON.parse(localStorage.getItem(`carrinho${e.id_user}`))||[]).filter(i=>i.id_produto!==o);localStorage.setItem(`carrinho${e.id_user}`,JSON.stringify(a)),F(i=>({...i,[o]:!1}))}catch(t){console.error("Erro ao remover produto do carrinho:",t),alert("Erro ao remover o produto do carrinho.")}},io=[{tamanho:"PP"},{tamanho:"P"},{tamanho:"M"},{tamanho:"G"},{tamanho:"GG"}],L=to(C,f,p,S,I),v=8,[j,no]=s.useState(1),J=(j-1)*v,co=J+v,lo=L.slice(J,co),M=Math.ceil(L.length/v),O=o=>{no(o)},uo=o=>{Z(`/produto/${o}`)};return r.jsxs(mo.Fragment,{children:[r.jsx(Io,{children:oo(d)}),r.jsx(Do,{children:h}),r.jsxs(po,{children:[r.jsxs(go,{children:[r.jsxs(xo,{children:[r.jsxs(y,{children:[r.jsx(B,{children:"Filtrar por cor"}),r.jsx(E,{children:r.jsx($,{children:ao.map(({nome:o,cor:t})=>r.jsx(fo,{style:{backgroundColor:t,border:f===o?"2px solid #A87826":"none"},onClick:()=>{g(f===o?null:o)}},o))})})]}),r.jsxs(y,{children:[r.jsx(B,{children:"Filtrar por tamanho"}),r.jsxs(E,{children:[r.jsx($,{children:io.map(({tamanho:o})=>r.jsx(q,{onClick:()=>N(o),style:p===o?{backgroundColor:"#A87826",color:"#fff"}:{},children:o},o))}),r.jsx(q,{onClick:()=>N("único"),style:p==="único"?{backgroundColor:"#A87826",color:"#fff",width:"3rem"}:{width:"3rem"},children:"Único"}),r.jsx(_o,{type:"number",placeholder:"Nº",value:p,onChange:o=>u(o.target.value)})]})]}),r.jsxs(y,{children:[r.jsx(B,{children:"Filtrar por preço"}),r.jsx(E,{children:r.jsxs($,{children:[r.jsxs(V,{children:[r.jsx(X,{children:"Mínimo"}),r.jsx(z,{type:"text",value:S,placeholder:"0",onChange:o=>l(o.target.value)})]}),r.jsx(jo,{children:r.jsx(wo,{})}),r.jsxs(V,{children:[r.jsx(X,{children:"Máximo"}),r.jsx(z,{type:"text",value:I,placeholder:"3000",onChange:o=>D(o.target.value)})]})]})})]})]}),r.jsx(Co,{onClick:()=>{g(null),u(""),l(""),D("")},children:"Remover Filtros"})]}),r.jsx(So,{children:r.jsxs(Po,{children:[lo.map(o=>r.jsxs(bo,{onClick:()=>uo(o.nome_produto),children:[o.img_produto&&r.jsx(No,{src:`http://localhost:3001/uploads/${o.img_produto}`,alt:o.nome_produto}),r.jsxs(Fo,{children:[o.nome_produto&&r.jsx(Ao,{children:o.nome_produto}),r.jsxs(vo,{children:[o.categoria_produto==="promocoes"?r.jsxs("div",{children:[r.jsx(Ro,{children:A(o.preco_produto)}),r.jsx(k,{children:A(o.preco_promocional_produto)})]}):r.jsx(k,{children:A(o.preco_produto)}),r.jsx(k,{children:ro(o.parcela_produto)})]}),r.jsxs(yo,{children:[r.jsx(H,{title:P[o.id_produto]?'Remover da lista "Amei"':"Adicionar no carrinho",onClick:t=>{t.stopPropagation(),P[o.id_produto]?so(o.id_produto):eo(o)},children:P[o.id_produto]?r.jsx(Eo,{}):r.jsx($o,{})}),r.jsx(H,{title:_[o.id_produto]?"Remover do carrinho":"Adicionar no carrinho",onClick:t=>{t.stopPropagation(),_[o.id_produto]?T(o.id_produto):R(o)},children:_[o.id_produto]?r.jsx(Bo,{}):r.jsx(ko,{})})]}),o.qtd_produto===0?r.jsx(K,{style:{background:"#FFF",color:"#A87826"},children:"Avise quando chegar"}):r.jsx(K,{title:_[o.id_produto]?"Remover do carrinho":"Adicionar no carrinho",onClick:t=>{t.stopPropagation(),_[o.id_produto]?T(o.id_produto):R(o)},children:_[o.id_produto]?"Remover do carrinho":"Adicionar ao carrinho"})]})]},o.id_produto)),r.jsxs(To,{children:[r.jsx(U,{disabled:j===1,onClick:()=>O(j-1),children:"Anterior"}),r.jsxs(ho,{children:["Página ",j," de ",M]}),r.jsx(U,{disabled:j===M,onClick:()=>O(j+1),children:"Próxima"})]})]})})]})]})},Uo=()=>{const{categoria:d}=Q(),[h,C]=s.useState({titulo:"",subtitulo:"",parcelamento:"",produtos:[]}),[e,f]=s.useState(!0),[g,p]=s.useState(null),u=w();return s.useEffect(()=>{(async()=>{try{const l=await x.get(`http://localhost:3001/aurea/produto/categoria/${d}`);if(!l.data.result||l.data.result.length===0)throw new Error("Categoria não encontrada.");C({titulo:`Produtos de ${d}`,subtitulo:`Confira todos os nossos produtos da categoria ${d}`,parcelamento:"Em até 12X",produtos:l.data.result})}catch{p("Categoria não encontrada."),u("/404",{replace:!0})}finally{f(!1)}})()},[d,u]),e?r.jsx(W,{}):g?r.jsx("div",{children:g}):r.jsx(Y,{titulo:h.titulo,subtitulo:h.subtitulo,produtos:h.produtos})},Ko=()=>{const{subcategoria:d}=Q(),[h,C]=s.useState({titulo:"",subtitulo:"",parcelamento:"",produtos:[]}),[e,f]=s.useState(!0),[g,p]=s.useState(null),u=w();return s.useEffect(()=>{(async()=>{try{const l=await x.get(`http://localhost:3001/aurea/produto/subcategoria/${d}`);if(!l.data.result||l.data.result.length===0)throw new Error("Subcategoria não encontrada.");C({titulo:`Produtos de ${d}`,subtitulo:`Confira todos os nossos produtos da subcategoria ${d}`,parcelamento:"Em até 12X",produtos:l.data.result})}catch{p("Subcategoria não encontrada."),u("/404",{replace:!0})}finally{f(!1)}})()},[d,u]),e?r.jsx(W,{}):g?r.jsx("div",{children:g}):r.jsx(Y,{titulo:h.titulo,subtitulo:h.subtitulo,produtos:h.produtos})};export{Uo as C,Ko as S};
