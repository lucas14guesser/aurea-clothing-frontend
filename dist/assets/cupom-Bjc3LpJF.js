import{a as r,j as e,R as T,T as u,C as G,g as E}from"./GlobalStyles-Dqpp29B9.js";import{C as O,a as $,b as B,c as M,L as a,d as n,e as c,S as A,B as P,f as z}from"./ProdutosStyle-8Z2-wOEa.js";import{M as V}from"./index-D6JL9M7r.js";import{a as H}from"./index-DT7h3x8e.js";import{b as J,d as K}from"./index-U_MZ96hN.js";import{a as i}from"./axios-DnYME9kn.js";import{R as b,M as Q,L as m,B as W}from"./UserDashboardStyles-BUujLACN.js";import{I as X,a as Y}from"./index-CVGnD8mp.js";import{U as Z}from"./userContext-Hfd7AKwO.js";import{a as ee,B as oe,b as se}from"./NavBarStyles-CgKT-dJj.js";import{a as re}from"./Functions-BNM27soa.js";import{C as te}from"./CdRastreioStyles-rUZR9pxi.js";function Ce(){const{user:p,logout:F}=r.useContext(Z),[h,x]=r.useState(""),[j,C]=r.useState(""),[f,v]=r.useState(""),[w,D]=r.useState([]),[d,y]=r.useState(""),[l,I]=r.useState(!1),[L,k]=r.useState(""),[_,g]=r.useState([]),S=()=>{I(!l)};r.useEffect(()=>{(async()=>{try{const s=await i.get("http://localhost:3001/aurea/listar-todos-cupom");D(s.data.result),g(s.data.result)}catch(s){console.error("Erro ao buscar todos os cupom.",s)}})()},[]);const N=o=>{const s=o.target.value.toLowerCase();k(s);const t=w.filter(q=>q.nome_cupom.toLowerCase().includes(s));g(t)},U=async o=>{o.preventDefault();const s={nome_cupom:h,validade_cupom:j,desconto_cupom:f};try{(await i.post("http://localhost:3001/aurea/gerar-cupom",s)).data.result?(alert("Cupom de desconto gerado com sucesso!"),x(""),C(""),v("")):alert("Erro ao gerar cupom de desconto.")}catch(t){console.error("Erro ao gerar cupom de desconto",t)}},R=async o=>{if(o.preventDefault(),!d){alert("Por favor, insira um nome de cupom válido");return}try{(await i.delete(`http://localhost:3001/aurea/deletar-cupom/${d}`)).data.result?(y(""),alert("Cupom de desconto excluído com sucesso!")):alert("Erro ao excluir cupom de desconto.")}catch(s){console.error("Erro ao excluir cupom de desconto",s),alert("Erro ao excluir cupom de desconto.")}};return e.jsxs(T.Fragment,{children:[l?e.jsxs(b,{children:[e.jsx(X,{style:{fontSize:"2rem",color:"#A87826",cursor:"pointer"},onClick:S}),e.jsxs(u,{children:["Boas-vindas, ",p.nome_user]})]}):e.jsxs(b,{children:[e.jsx(Y,{style:{fontSize:"2rem",color:"#A87826",cursor:"pointer"},onClick:S}),e.jsxs(u,{children:["Boas-vindas, ",p.nome_user]})]}),l&&e.jsxs(Q,{children:[e.jsx(m,{to:"/minha-conta",children:"Minha Conta"}),e.jsx(m,{to:"/pedidos-ativos",children:"Pedidos Ativos"}),e.jsx(m,{to:"/pedidos-encerrados",children:"Pedidos Encerrados"}),e.jsx(W,{onClick:F,children:"Sair"})]}),e.jsxs(G,{children:[e.jsx(u,{children:"Cupom"}),e.jsx(O,{children:e.jsxs($,{children:[e.jsx(B,{children:e.jsxs(M,{children:[e.jsx(E,{style:{color:"#A87826"},children:"Cadastrar cupom de desconto"}),e.jsxs(a,{children:[e.jsx(n,{htmlFor:"nome_cupom",children:e.jsx(J,{})}),e.jsx(c,{type:"text",placeholder:"Nome do Cupom",id:"nome_cupom",required:!0,value:h,onChange:o=>x(o.target.value)})]}),e.jsxs(a,{children:[e.jsx(n,{htmlFor:"validade_cupom",children:e.jsx(K,{})}),e.jsx(c,{type:"date",id:"validade_cupom",name:"validade_cupom",required:!0,value:j,onChange:o=>C(o.target.value)})]}),e.jsxs(a,{children:[e.jsx(n,{htmlFor:"desconto_cupom",children:e.jsx(V,{})}),e.jsx(c,{type:"number",placeholder:"Desconto do Cupom em %",id:"desconto_cupom",required:!0,value:f,onChange:o=>v(o.target.value)})]}),e.jsx(A,{children:e.jsx(P,{onClick:U,children:"Gerar"})})]})}),e.jsx(B,{children:e.jsxs(M,{children:[e.jsx(E,{style:{color:"#A87826"},children:"Excluir cupom de desconto"}),e.jsxs(a,{children:[e.jsx(n,{htmlFor:"nome_cupom",children:e.jsx(H,{})}),e.jsx(c,{type:"text",id:"nome_cupom",placeholder:"Nome do cupom",value:d,onChange:o=>y(o.target.value)})]}),e.jsx(A,{children:e.jsx(P,{onClick:R,children:"Excluir Cupom"})})]})})]})}),e.jsxs(te,{children:[e.jsx(ee,{type:"text",name:"searchCupom",id:"searchCupom",value:L,placeholder:"Cupom que procura?",onChange:N}),e.jsx(oe,{children:e.jsx(se,{})})]}),e.jsx(z,{children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nome"}),e.jsx("th",{children:"Validade"}),e.jsx("th",{children:"Desconto"})]})}),e.jsx("tbody",{children:Array.isArray(_)&&_.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:o.nome_cupom}),e.jsx("td",{children:`Até ${re(o.validade_cupom)}`}),e.jsx("td",{children:`${o.desconto_cupom}%`})]},o.nome_cupom))})]})})]})]})}export{Ce as C};
