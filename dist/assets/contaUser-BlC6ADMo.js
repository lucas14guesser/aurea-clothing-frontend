import{j as e,a,f as T,b,T as k,S as D}from"./GlobalStyles-Dqpp29B9.js";import{C as q,S as M,F as l,L as u,I as h,e as O,a as N,B as U,f as F,g as G,h as H,c as J,b as K}from"./ContaUserStyles-jzYrjlID.js";import{a as g,R as Q}from"./index-CmN5j4cY.js";import{a as w}from"./axios-DnYME9kn.js";import{U as V}from"./userContext-Hfd7AKwO.js";import{M as W,a as X}from"./ModalsStyles-CkMaqKjX.js";function Y({children:t}){return e.jsx(W,{children:e.jsx(X,{onClick:r=>r.stopPropagation(),style:{width:"30rem"},children:t})})}function Z(){const[t,r]=a.useState(""),[i,m]=a.useState(""),[c,o]=a.useState(""),[f,p]=a.useState(""),[S,P]=a.useState(!1),[x,C]=a.useState(""),[B,d]=a.useState(""),[v,E]=a.useState(""),[L,y]=a.useState(!1),I=T(),{login:_}=a.useContext(V),z=async n=>{if(n.preventDefault(),o(""),p(""),!t||!i){o("Preencha todos os campos.");return}const j={email_user:t,senha_user:i};try{const s=await w.post("http://localhost:3001/aurea/login",j,{withCredentials:!0});s.status===200&&s.data.success?(p("Login bem-sucedido!"),await _(t),I("/minha-conta")):o("Falha ao fazer login. Por favor, tente novamente.")}catch(s){s.response&&s.response.status===400?o(s.response.data.message):s.response&&s.response.status===401?o("Credenciais inválidas. Tente novamente."):o("Ocorreu um erro no servidor. Por favor, tente mais tarde.")}},R=()=>{P(!S)},A=async n=>{n.preventDefault(),y(!0);const j={email_user:x};if(!x){d("E-mail é obrigatório");return}try{const s=await w.post("http://localhost:3001/aurea/usuario/senha/esqueci-senha",j);s.data.error?(E(""),d(s.data.error)):(E("E-mail enviado com sucesso. Siga as instruções para trocar de senha."),d(""),C(""))}catch(s){d("Erro ao enviar e-mail."),console.error(s)}finally{y(!1)}};return e.jsxs(q,{children:[" ",e.jsxs(M,{children:[" ","Acesse sua conta"]}),e.jsxs("form",{onSubmit:z,children:[" ",e.jsxs(l,{children:[" ",e.jsxs(u,{htmlFor:"email-login",children:[" ",e.jsx(g,{})," "]}),e.jsx(h,{type:"email",name:"email-login",id:"email-login",placeholder:"E-mail",required:!0,value:t,onChange:n=>r(n.target.value)})]}),e.jsxs(l,{children:[" ",e.jsxs(u,{htmlFor:"senha-login",children:[" ",e.jsx(Q,{})," "]}),e.jsx(h,{type:"password",name:"senha-login",id:"senha-login",placeholder:"Senha",required:!0,value:i,onChange:n=>m(n.target.value)})]}),c&&e.jsx(b,{children:c})," ",f&&e.jsx("p",{style:{color:"green"},children:f})," ",e.jsxs(O,{children:[" ",e.jsxs(N,{onClick:R,children:[" ","Esqueci minha senha"]}),e.jsxs(U,{type:"submit",children:[" ","Entrar"]})]})]}),S&&e.jsxs(Y,{children:[e.jsx(k,{children:"Esqueci minha senha"}),e.jsxs(l,{children:[e.jsx(u,{children:e.jsx(g,{})}),e.jsx(h,{type:"email",placeholder:"Seu e-mail",value:x,onChange:n=>C(n.target.value)})]}),v?e.jsx(D,{children:v}):e.jsx(b,{children:B}),e.jsxs(l,{children:[e.jsx(F,{type:"submit",onClick:A,disabled:L,children:L?"Enviando...":"Enviar"}),e.jsx(F,{type:"submit",onClick:R,children:"Fechar"})]})]})]})}function $(){return e.jsxs(G,{children:[" ",e.jsxs(H,{children:[" ","Se você ainda não tem uma conta, por favor, cadastre-se ao lado. "]})]})}function ee(){const[t,r]=a.useState(""),i=T(),m=o=>{r(o.target.value)},c=()=>{t?i("/cadastro",{state:{emailSettado:t}}):alert("E-mail é obrigatório.")};return e.jsxs(q,{children:[" ",e.jsx(M,{style:{marginBottom:"1.5rem"},children:"Realize o cadastro"})," ",e.jsxs(l,{children:[" ",e.jsxs(u,{htmlFor:"email-cadastro",children:[" ",e.jsx(g,{})," "]}),e.jsx(h,{type:"email",name:"email-cadastro",id:"email-cadastro",placeholder:"E-mail",required:!0,value:t,onChange:m})," "]}),e.jsx(U,{onClick:c,children:"Cadastrar"})," "]})}function se(){return e.jsxs(J,{children:[" ",e.jsx(Z,{})," ",e.jsx($,{})," ",e.jsx(ee,{})," "]})}function ae(){return e.jsxs(k,{children:[" ","Acesse sua conta ou cadastre-se"]})}function ce(){return e.jsxs(K,{children:[" ",e.jsx(ae,{})," ",e.jsx(se,{})," "]})}export{ce as C};
