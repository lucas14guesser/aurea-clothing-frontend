import{a as s,f as w,j as r,R as mo,l as ho,m as Q}from"./GlobalStyles-Dqpp29B9.js";import{C as po,a as go,b as xo,F as v,c as y,d as E,B as fo,e as q,I as _o,f as V,L as X,g as z,T as bo,h as jo,i as Co,j as So,k as Po,l as Ao,N as Fo,D as ko,m as vo,n as H}from"./CategoriaProdutosStyle-Bi6KNH5F.js";import{T as yo,a as Eo,b as $o,c as Bo}from"./index-CJGrLZTX.js";import{c as wo}from"./index-U_MZ96hN.js";import{a as Io,S as Do,b as $,I as No,P as Ro,c as B,C as To,B as U}from"./ProdutoStyles-Cz6hDj1C.js";import{U as Lo}from"./userContext-D66xfPlX.js";import{a as x}from"./axios-DnYME9kn.js";import{B as K}from"./HomePageStyles-CJMC4Gvw.js";import{S as W}from"./SpinnerComponent-D-z1JUIS.js";const Y=({titulo:d,subtitulo:h,produtos:j})=>{const{user:a}=s.useContext(Lo),[f,g]=s.useState(null),[p,u]=s.useState(""),[C,l]=s.useState(""),[I,D]=s.useState(""),[S,P]=s.useState({}),[_,A]=s.useState({}),Z=w();s.useEffect(()=>{if(a&&a.id_user){const t=(JSON.parse(localStorage.getItem(`listaAmei_${a.id_user}`))||[]).reduce((e,i)=>(e[i.id_produto]=!0,e),{});P(t)}},[a]),s.useEffect(()=>{if(a&&a.id_user){const t=(JSON.parse(localStorage.getItem(`carrinho${a.id_user}`))||[]).reduce((e,i)=>(e[i.id_produto]=!0,e),{});A(t)}},[a]);const F=o=>typeof o!="number"?"0,00":o.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),oo=o=>{if(!o)return"";const t={calcas:"calças",acessorios:"acessórios",bones:"bonés",lancamentos:"lançamentos",promocoes:"promoções"};let e=o;for(let i in t){const m=new RegExp(`\\b${i}\\b`,"g");e=e.replace(m,t[i])}return e},ro=o=>!o||o===1?"À vista":`Em até ${o}X`,N=o=>{u(p===o?null:o)},to=(o,t,e,i,m)=>{if(!Array.isArray(o))return console.error("Produtos não é um array válido"),[];let n=o;return t&&(n=n.filter(c=>c.cor_produto===t)),e&&(n=n.filter(c=>c.tamanho_produto===e)),i&&m&&(n=n.filter(c=>{const G=c.categoria_produto==="promocoes"&&c.preco_promocional_produto?c.preco_promocional_produto:c.preco_produto;return G>=i&&G<=m})),n},eo=[{nome:"amarelo",cor:"#FFF800"},{nome:"azul",cor:"#007BFF"},{nome:"branco",cor:"#fff"},{nome:"cinza",cor:"#737373"},{nome:"laranja",cor:"#FA5400"},{nome:"marrom",cor:"#8C5900"},{nome:"nude",cor:"#F2D2BD"},{nome:"preto",cor:"#000"},{nome:"rosa",cor:"#FFDBDB"},{nome:"rosê",cor:"#C21E56"},{nome:"roxo",cor:"#A347FF"},{nome:"verde",cor:"#00AD1D"},{nome:"vermelho",cor:"#8C0000"},{nome:"lilás",cor:"#C8A2C8"}],ao=async o=>{if(!(a!=null&&a.id_user)){alert("Você precisa estar logado para adicionar à lista amei.");return}const t=a.id_user;try{const e=JSON.parse(localStorage.getItem(`listaAmei_${t}`))||[];if(e.some(c=>c.id_produto===o.id_produto)||(await x.get(`https://test-aureaclothing-backend-466bc65ebfec.herokuapp.com/aurea/lista-amei/${t}`)).data.some(c=>c.id_produto===o.id_produto))return;const n=await x.post("https://test-aureaclothing-backend-466bc65ebfec.herokuapp.com/aurea/lista-amei",{id_user:t,id_produto:o.id_produto});if(n.status!==200&&n.status!==201)throw new Error('Erro ao adicionar o produto à lista "Amei".');e.push(o),localStorage.setItem(`listaAmei_${t}`,JSON.stringify(e)),P(c=>({...c,[o.id_produto]:!0}))}catch(e){console.error('Erro ao adicionar à lista "Amei":',e.response?e.response.data:e.message),alert("Erro ao adicionar o produto à lista.")}},so=async o=>{try{const t=a.id_user;await x.delete(`https://test-aureaclothing-backend-466bc65ebfec.herokuapp.com/aurea/lista-amei/${t}/${o}`);const i=(JSON.parse(localStorage.getItem(`listaAmei_${t}`))||[]).filter(m=>m.id_produto!==o);localStorage.setItem(`listaAmei_${t}`,JSON.stringify(i)),P(m=>({...m,[o]:!1}))}catch(t){console.error('Erro ao remover produto da lista "Amei":',t),alert("Erro ao remover o produto da lista.")}},R=async o=>{if(!(a!=null&&a.id_user)){alert("Você precisa estar logado para adicionar ao carrinho.");return}const t=a.id_user;if(o.qtd_produto===0){alert("Você não pode colocar um produto sem estoque no carrinho.");return}else try{const e=JSON.parse(localStorage.getItem(`carrinho${t}`))||[];if(e.some(n=>n.id_produto===o.id_produto)||(await x.get(`https://test-aureaclothing-backend-466bc65ebfec.herokuapp.com/aurea/carrinho/${t}`)).data.some(n=>n.id_produto===o.id_produto))return;await x.post("https://test-aureaclothing-backend-466bc65ebfec.herokuapp.com/aurea/carrinho",{id_user:t,id_produto:o.id_produto,qtd_produto_carrinho:1}),e.push(o),localStorage.setItem(`carrinho${t}`,JSON.stringify(e)),A(n=>({...n,[o.id_produto]:!0}))}catch(e){console.error("Erro ao adicionar ao carrinho:",e),alert("Erro ao adicionar o produto no carrinho.")}},T=async o=>{try{await x.delete(`https://test-aureaclothing-backend-466bc65ebfec.herokuapp.com/aurea/carrinho/${a.id_user}/${o}`);const e=(JSON.parse(localStorage.getItem(`carrinho${a.id_user}`))||[]).filter(i=>i.id_produto!==o);localStorage.setItem(`carrinho${a.id_user}`,JSON.stringify(e)),A(i=>({...i,[o]:!1}))}catch(t){console.error("Erro ao remover produto do carrinho:",t),alert("Erro ao remover o produto do carrinho.")}},io=[{tamanho:"PP"},{tamanho:"P"},{tamanho:"M"},{tamanho:"G"},{tamanho:"GG"}],L=to(j,f,p,C,I),k=8,[b,no]=s.useState(1),J=(b-1)*k,co=J+k,lo=L.slice(J,co),M=Math.ceil(L.length/k),O=o=>{no(o)},uo=o=>{Z(`/produto/${o}`)};return r.jsxs(mo.Fragment,{children:[r.jsx(Io,{children:oo(d)}),r.jsx(Do,{children:h}),r.jsxs(po,{children:[r.jsxs(go,{children:[r.jsxs(xo,{children:[r.jsxs(v,{children:[r.jsx($,{children:"Filtrar por cor"}),r.jsx(y,{children:r.jsx(E,{children:eo.map(({nome:o,cor:t})=>r.jsx(fo,{style:{backgroundColor:t,border:f===o?"2px solid #A87826":"none"},onClick:()=>{g(f===o?null:o)}},o))})})]}),r.jsxs(v,{children:[r.jsx($,{children:"Filtrar por tamanho"}),r.jsxs(y,{children:[r.jsx(E,{children:io.map(({tamanho:o})=>r.jsx(q,{onClick:()=>N(o),style:p===o?{backgroundColor:"#A87826",color:"#fff"}:{},children:o},o))}),r.jsx(q,{onClick:()=>N("único"),style:p==="único"?{backgroundColor:"#A87826",color:"#fff",width:"3rem"}:{width:"3rem"},children:"Único"}),r.jsx(_o,{type:"number",placeholder:"Nº",value:p,onChange:o=>u(o.target.value)})]})]}),r.jsxs(v,{children:[r.jsx($,{children:"Filtrar por preço"}),r.jsx(y,{children:r.jsxs(E,{children:[r.jsxs(V,{children:[r.jsx(X,{children:"Mínimo"}),r.jsx(z,{type:"text",value:C,placeholder:"0",onChange:o=>l(o.target.value)})]}),r.jsx(bo,{children:r.jsx(wo,{})}),r.jsxs(V,{children:[r.jsx(X,{children:"Máximo"}),r.jsx(z,{type:"text",value:I,placeholder:"3000",onChange:o=>D(o.target.value)})]})]})})]})]}),r.jsx(jo,{onClick:()=>{g(null),u(""),l(""),D("")},children:"Remover Filtros"})]}),r.jsx(Co,{children:r.jsxs(So,{children:[lo.map(o=>r.jsxs(Po,{onClick:()=>uo(o.nome_produto),children:[o.img_produto&&r.jsx(No,{src:`https://test-aureaclothing-backend-466bc65ebfec.herokuapp.com/uploads/${o.img_produto}`,alt:o.nome_produto}),r.jsxs(Ao,{children:[o.nome_produto&&r.jsx(Fo,{children:o.nome_produto}),r.jsxs(ko,{children:[o.categoria_produto==="promocoes"?r.jsxs("div",{children:[r.jsx(Ro,{children:F(o.preco_produto)}),r.jsx(B,{children:F(o.preco_promocional_produto)})]}):r.jsx(B,{children:F(o.preco_produto)}),r.jsx(B,{children:ro(o.parcela_produto)})]}),r.jsxs(vo,{children:[r.jsx(H,{title:S[o.id_produto]?'Remover da lista "Amei"':"Adicionar no carrinho",onClick:t=>{t.stopPropagation(),S[o.id_produto]?so(o.id_produto):ao(o)},children:S[o.id_produto]?r.jsx(yo,{}):r.jsx(Eo,{})}),r.jsx(H,{title:_[o.id_produto]?"Remover do carrinho":"Adicionar no carrinho",onClick:t=>{t.stopPropagation(),_[o.id_produto]?T(o.id_produto):R(o)},children:_[o.id_produto]?r.jsx($o,{}):r.jsx(Bo,{})})]}),o.qtd_produto===0?r.jsx(K,{style:{background:"#FFF",color:"#A87826"},children:"Avise quando chegar"}):r.jsx(K,{title:_[o.id_produto]?"Remover do carrinho":"Adicionar no carrinho",onClick:t=>{t.stopPropagation(),_[o.id_produto]?T(o.id_produto):R(o)},children:_[o.id_produto]?"Remover do carrinho":"Adicionar ao carrinho"})]})]},o.id_produto)),r.jsxs(To,{children:[r.jsx(U,{disabled:b===1,onClick:()=>O(b-1),children:"Anterior"}),r.jsxs(ho,{children:["Página ",b," de ",M]}),r.jsx(U,{disabled:b===M,onClick:()=>O(b+1),children:"Próxima"})]})]})})]})]})},Uo=()=>{const{categoria:d}=Q(),[h,j]=s.useState({titulo:"",subtitulo:"",parcelamento:"",produtos:[]}),[a,f]=s.useState(!0),[g,p]=s.useState(null),u=w();return s.useEffect(()=>{(async()=>{try{const l=await x.get(`https://test-aureaclothing-backend-466bc65ebfec.herokuapp.com/aurea/produto/categoria/${d}`);if(!l.data.result||l.data.result.length===0)throw new Error("Categoria não encontrada.");j({titulo:`Produtos de ${d}`,subtitulo:`Confira todos os nossos produtos da categoria ${d}`,parcelamento:"Em até 12X",produtos:l.data.result})}catch{p("Categoria não encontrada."),u("/404",{replace:!0})}finally{f(!1)}})()},[d,u]),a?r.jsx(W,{}):g?r.jsx("div",{children:g}):r.jsx(Y,{titulo:h.titulo,subtitulo:h.subtitulo,produtos:h.produtos})},Ko=()=>{const{subcategoria:d}=Q(),[h,j]=s.useState({titulo:"",subtitulo:"",parcelamento:"",produtos:[]}),[a,f]=s.useState(!0),[g,p]=s.useState(null),u=w();return s.useEffect(()=>{(async()=>{try{const l=await x.get(`https://test-aureaclothing-backend-466bc65ebfec.herokuapp.com/aurea/produto/subcategoria/${d}`);if(!l.data.result||l.data.result.length===0)throw new Error("Subcategoria não encontrada.");j({titulo:`Produtos de ${d}`,subtitulo:`Confira todos os nossos produtos da subcategoria ${d}`,parcelamento:"Em até 12X",produtos:l.data.result})}catch{p("Subcategoria não encontrada."),u("/404",{replace:!0})}finally{f(!1)}})()},[d,u]),a?r.jsx(W,{}):g?r.jsx("div",{children:g}):r.jsx(Y,{titulo:h.titulo,subtitulo:h.subtitulo,produtos:h.produtos})};export{Uo as C,Ko as S};
