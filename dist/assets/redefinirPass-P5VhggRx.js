import{a as r,u as D,j as e,R as w,T as a,S as M,b as F}from"./GlobalStyles-Dqpp29B9.js";import{R as j,M as I,L as t,B as b,C as B,F as P}from"./UserDashboardStyles-BUujLACN.js";import{I as U,a as A}from"./index-CVGnD8mp.js";import{U as N}from"./userContext-Hfd7AKwO.js";import{F as o,L as f,I as p,a as _,B as E}from"./ContaUserStyles-jzYrjlID.js";import{R as S}from"./index-CmN5j4cY.js";import{a as V}from"./axios-DnYME9kn.js";function X(){const{user:n,logout:C}=r.useContext(N),[d,v]=r.useState(""),[R,y]=r.useState(""),[l,c]=r.useState(""),[h,u]=r.useState(""),[T]=D(),q=T.get("token"),[x,L]=r.useState(!1),[i,z]=r.useState(!1),m=()=>{z(!i)},k=async s=>{if(s.preventDefault(),L(!0),d!==R){u("As senhas nÃ£o coincidem."),c("");return}try{const g=await V.put("http://localhost:3001/aurea/usuario/senha/redefinir-senha",{token:q,senha_user:d});g.data.error?(u(g.data.error),c("")):(c("Senha redefinida com sucesso."),u(""),setTimeout(()=>C(),1500))}catch{u("Erro ao redefinir senha. Tente novamente."),c("")}finally{L(!1)}};if(n.funcao_user==="admin")return e.jsxs(w.Fragment,{children:[i?e.jsxs(j,{children:[e.jsx(U,{style:{fontSize:"2rem",color:"#A87826",cursor:"pointer"},onClick:m}),e.jsxs(a,{children:["Boas-vindas, ",n.nome_user]})]}):e.jsxs(j,{children:[e.jsx(A,{style:{fontSize:"2rem",color:"#A87826",cursor:"pointer"},onClick:m}),e.jsxs(a,{children:["Boas-vindas, ",n.nome_user]})]}),i&&e.jsxs(I,{children:[e.jsx(t,{to:"/minha-conta",children:"Minha Conta"}),e.jsx(t,{to:"/pedidos-ativos",children:"Pedidos Ativos"}),e.jsx(t,{to:"/pedidos-encerrados",children:"Pedidos Encerrados"}),e.jsx(b,{onClick:C,children:"Sair"})]}),e.jsx(B,{children:e.jsxs(P,{onSubmit:k,children:[e.jsx(a,{children:"Redefinir Senha"}),e.jsxs(o,{children:[e.jsx(f,{htmlFor:"senha-red",children:e.jsx(S,{})}),e.jsx(p,{type:"password",placeholder:"Nova senha",name:"senha-red",required:!0,value:d,onChange:s=>v(s.target.value)})]}),e.jsxs(o,{children:[e.jsx(f,{htmlFor:"senha-conf-red",children:e.jsx(S,{})}),e.jsx(p,{type:"password",placeholder:"Confirmar nova senha",name:"senha-conf-red",required:!0,value:R,onChange:s=>y(s.target.value)})]}),l&&e.jsx(M,{children:l}),h&&e.jsx(F,{children:h}),e.jsxs(o,{style:{alignItems:"flex-end",gap:"2rem"},children:[e.jsx(_,{to:"/minha-conta",children:"Voltar"}),e.jsx(E,{type:"submit",disabled:x,style:{width:"10rem"},children:x?"Redefinindo...":"Redefinir"})]})]})})]});if(n.funcao_user==="user")return e.jsxs(w.Fragment,{children:[i?e.jsxs(j,{children:[e.jsx(U,{style:{fontSize:"2rem",color:"#A87826",cursor:"pointer"},onClick:m}),e.jsxs(a,{children:["Boas-vindas, ",n.nome_user]})]}):e.jsxs(j,{children:[e.jsx(A,{style:{fontSize:"2rem",color:"#A87826",cursor:"pointer"},onClick:m}),e.jsxs(a,{children:["Boas-vindas, ",n.nome_user]})]}),i&&e.jsxs(I,{children:[e.jsx(t,{to:"/minha-conta",children:"Minha Conta"}),e.jsx(t,{to:"/meus-pedidos",children:"Meus Pedidos"}),e.jsx(b,{onClick:C,children:"Sair"})]}),e.jsx(B,{children:e.jsxs(P,{onSubmit:k,children:[e.jsx(a,{children:"Redefinir Senha"}),e.jsxs(o,{children:[e.jsx(f,{htmlFor:"senha-red",children:e.jsx(S,{})}),e.jsx(p,{type:"password",placeholder:"Nova senha",name:"senha-red",required:!0,value:d,onChange:s=>v(s.target.value)})]}),e.jsxs(o,{children:[e.jsx(f,{htmlFor:"senha-conf-red",children:e.jsx(S,{})}),e.jsx(p,{type:"password",placeholder:"Confirmar nova senha",name:"senha-conf-red",required:!0,value:R,onChange:s=>y(s.target.value)})]}),l&&e.jsx(M,{children:l}),h&&e.jsx(F,{children:h}),e.jsxs(o,{style:{alignItems:"flex-end",gap:"2rem"},children:[e.jsx(_,{to:"/minha-conta",children:"Voltar"}),e.jsx(E,{type:"submit",disabled:x,style:{width:"10rem"},children:x?"Redefinindo...":"Redefinir"})]})]})})]})}export{X as R};
